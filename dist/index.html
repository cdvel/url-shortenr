<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>url shortener</title>
		<link rel="stylesheet" href="https://unpkg.com/baseguide@3.2.1/dist/css/baseguide.min.css">
		<!-- <script src="https://www.gstatic.com/firebasejs/6.6.0/firebase-functions.js"></script> -->
		<style type="text/css">
			.row{
				border: 1px solid #ccc;
				padding: 40px 0px;
				margin: 30px 0px;
				width: 100% !important;
				display: 'inline-flex';
				.div{
					padding: 0px 10px;
				}
			}
			@media only screen and (max-width: 600px) {
				.row{
					width: 100% !important;
				}
			}
		</style>
	</head>
	<body>
		<div id="message" class="container">
			<h3>URL shortening service</h3>
			<hr/>
			<div class="container">
				<form id="form">
					<div class="row">
						<div class="col col-md-8">
							<input id="long-url" type="text" placeholder="https://your-long-url-goes-here.com">
						</div>
						<div class="col col-md-4">
							<input class="btn" type="submit" value="Shorten URL âœ‚ï¸">
						</div>
					</div>
				</form>
				<div class="row">
					<div class="col col-md-12">
						<p>Your shortened URL ðŸ‘‡</p>
					</div>
					<div class="col col-md-12">
						<a id="shortened-url" class="btn" href="/" role="button" target="_blank">ðŸ“ŒðŸ“ŒðŸ“Œ</a>
					</div>
				</div>
			</div>
		</div>
		<!-- The core Firebase JS SDK is always required and must be listed first -->
		<!-- <script src="/__/firebase/6.6.0/firebase-app.js"></script> -->
		<script src="https://www.gstatic.com/firebasejs/6.6.0/firebase.js"></script>
		<script type="text/javascript">
			// Your web app's Firebase configuration
			var firebaseConfig = {
			apiKey: "AIzaSyBJJkt3k0OLFu2cq8h7VkmiLeiY12z2-U4",
			authDomain: "cdvel-co.firebaseapp.com",
			databaseURL: "https://cdvel-co.firebaseio.com",
			projectId: "cdvel-co",
			storageBucket: "cdvel-co.appspot.com",
			messagingSenderId: "358910035685",
			appId: "1:358910035685:web:846435b97b67379978f60c"
			};
			// Initialize Firebase
			firebase.initializeApp(firebaseConfig);
			const functions = firebase.functions();
			let form = document.querySelector("#form")
			form.addEventListener("submit", (e) => {
				e.preventDefault();
				const url = document.querySelector("#long-url").value;
				const shorty = document.querySelector("#shortened-url");
				const shortenFn = functions.httpsCallable('redirect');
				shortenFn(url).then((result) => {
					shorty.href = document.URL+result.data;
					shorty.textContent = document.URL+result.data;
				});
			});
		</script>
	</body>
</html>